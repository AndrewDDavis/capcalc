#!/bin/csh -f

echo 'extracting timecourses'
#roidecompose Resting_101309/REST1_LR/origional/101309_Hutch17CortStriatAmyg_MNI_REST1_LR.txt \
#    Hutch17CortStriatAmyg_MNI.nii.gz \
#    orig_hcptcs.txt \
#    --stdnorm
cp Resting_101309/REST1_LR/origional/101309_Hutch17CortStriatAmyg_MNI_REST1_LR.txt output/orig_hcptcs.txt
#roidecompose Resting_101309/REST1_LR/rapidtide/101309_rapidtide_Hutch17CortStriatAmyg_MNI_REST1_LR.txt \
#    Hutch17CortStriatAmyg_MNI.nii.gz \
#    rapidtide_hcptcs.txt \
#    --stdnorm
cp Resting_101309/REST1_LR/rapidtide/101309_rapidtide_Hutch17CortStriatAmyg_MNI_REST1_LR.txt output/rapidtide_hcptcs.txt


echo 'calculating kmeans'
capfromtcs -i output/orig_hcptcs.txt -o output/orig_hcp --sampletime=0.72
capfromtcs -i output/rapidtide_hcptcs.txt -o output/rapidtide_hcp --sampletime=0.72

echo 'remapping onto rosi states'
statematch rosi_orig.txt output/orig_hcp_statelabels.txt output/orig
statematch rosi_rapidtide.txt output/rapidtide_hcp_statelabels.txt output/rapidtide

echo 'projecting clusters back onto the brain'
roirecompose output/orig_hcp_clustercenters.txt Hutch17CortStriatAmyg_MNI.nii.gz output/orig_states
roirecompose output/rapidtide_hcp_clustercenters.txt Hutch17CortStriatAmyg_MNI.nii.gz output/rapidtide_states

fslview output/orig_states -l Hot -b 0.1,2 output/rapidtide_states -l Hot -b 0.1,2
